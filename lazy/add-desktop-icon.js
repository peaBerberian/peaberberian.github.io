/** This is the code for the app identified as "add-desktop-icon". */
function p(l,e){let i=document.createElement("div");d(i,{position:"relative",height:"100%",overflow:"hidden",width:"100%",backgroundColor:e.STYLE.bgColor});let s=document.createElement("div");d(s,{display:"none",position:"absolute",height:"100%",width:"100%",alignItems:"center",justifyContent:"center"});let a=document.createElement("div");return a.className="spinner",s.appendChild(a),i.appendChild(s),s.style.display="flex",e.filePickerOpen({title:"Choose apps or files that should be added as desktop shortcuts",allowMultipleSelections:!0,baseDirectory:"/apps/",confirmValue:"Add to desktop"}).then(async n=>{if(n.length===0){e.closeApp();return}let r=[];try{for(let t of n)if(t.filename.endsWith(".run")){let c=await e.filesystem.readFile(t.filePath,"object");r.push({run:t.filePath,args:[],title:c.title,icon:c.icon})}else r.push({run:t.filePath,args:[],title:t.filename,icon:t.filename[0]});let o;try{o=await e.filesystem.readFile("/userconfig/desktop.config.json","object")}catch(t){if(t.name!=="FileSystemError"||t.code!=="NoEntryError")throw t;o=await e.filesystem.readFile("/system32/default-desktop.json","object")}o.list.push(...r),await e.filesystem.writeFile("/userconfig/desktop.config.json",JSON.stringify(o,null,2)),e.notificationEmitter.success("Desktop icons","Added new desktop icons with success!")}catch(o){e.notificationEmitter.error("Failed to add desktop icon","Failed to update icons: "+o.toString())}s.style.display="none",e.closeApp()},n=>{e.notificationEmitter.error("Failed to add desktop icon","The file picker encountered an issue: "+n.toString()),e.closeApp()}),{element:i}}function d(l,e){for(let i of Object.keys(e))l.style[i]=e[i]}export{p as create};
