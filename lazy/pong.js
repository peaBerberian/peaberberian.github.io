/** This is the code for the app identified as "pong". */
var k=16.666666666666668;function B(f,i,h){let r=document.createElement("div");G(r,{backgroundColor:i.STYLE.windowActiveHeader,color:i.STYLE.windowActiveHeaderText,height:"100%",width:"100%",overflowY:"auto",margin:"0",padding:"0",overflow:"hidden"});let l,A=0,E=null,L=new ResizeObserver(o=>{for(let t of o)t.contentRect&&(E!==null&&clearTimeout(E),E=setTimeout(()=>{E=null,r.innerHTML="",v(t.contentRect)},50))});L.observe(r),h.addEventListener("abort",()=>{L.unobserve(r)});let n,y=!1,d,m=!1,T=!1;return v(r.getBoundingClientRect()),r.addEventListener("mousemove",S,{passive:!1}),r.addEventListener("touchmove",R,{passive:!1}),r.onselectstart=o=>o.preventDefault(),{element:r,onActivate:()=>{document.addEventListener("keydown",P),document.addEventListener("keyup",g)},onDeactivate:()=>{document.removeEventListener("keydown",P),document.removeEventListener("keyup",g),m=!1,T=!1}};function v(o){r.innerHTML="",o.width>0&&o.height>0?r.appendChild(Y(o)):l!==void 0&&(window.cancelAnimationFrame(l),l=void 0)}function P(o){switch(o.key){case"ArrowUp":m=!0;break;case"ArrowDown":T=!0;break;case" ":y=!0;break}}function g(o){switch(o.key){case"ArrowUp":m=!1;break;case"ArrowDown":T=!1;break}}function R(o){if(o.touches.length===1){let t=o.touches[0],e=r.getBoundingClientRect(),s=t.clientY-e.top;d.y=Math.max(0,Math.min(s-80/2,n.height-80))}}function S(o){if(!n)return;let t=n.getBoundingClientRect(),e=o.clientY-t.top;d.y=Math.max(0,Math.min(e-80/2,n.height-80))}function Y(o){l!==void 0&&(window.cancelAnimationFrame(l),l=void 0),n=document.createElement("canvas"),n.width=o.width,n.height=o.height,G(n,{height:"100%",width:"100%",backgroundColor:i.STYLE.windowActiveHeader});let t=n.getContext("2d"),e={x:n.width/2,y:n.height/2,radius:10,dx:5,dy:5,prevX:n.width/2,prevY:n.height/2},s={x:0,y:n.height/2-80/2};d={x:n.width-10,y:n.height/2-80/2},y=!1;let u=0,D=0,c=8;w(!1,!1),n.addEventListener("click",()=>{y=!0});let p=performance.now();return A=p,_(p),n;function _(a){let H=a-A;H+.1>=k&&(C(),A=a-H%k),l=window.requestAnimationFrame(_)}function C(){if(m?d.y=Math.max(0,d.y-5):T&&(d.y=Math.min(n.height-80,d.y+5)),!y){w(!1,!1),t.font="32px monospace",t.fillText("Click to start a game",10,50);return}w(!0,!0);let a=s.y+80/2;a<e.y-20?s.y+=Math.min(12,e.y-a,c):a>e.y+20?s.y-=Math.min(12,a-e.y,c):a<e.y-10?s.y+=Math.min(7,e.y-a,c):a>e.y+10?s.y-=Math.min(7,a-e.y,c):a<e.y-5?s.y+=1:a>e.y+5&&(s.y-=1),s.y=Math.max(0,Math.min(s.y,n.height-80)),e.prevX=e.x,e.prevY=e.y,e.x+=e.dx,e.y+=e.dy,(e.y+e.radius>n.height||e.y-e.radius<0)&&(e.dy=-e.dy),e.dx<0?M(s,e):e.dx>0&&M(d,e)&&(D-u>3?c=12:D-u>=2?c=x(10,12):D-u<-3?c=4:D-u<=-2?c=x(4,8):D-u<=-1?c=x(8,11):c=x(6,10)),e.x+e.radius>n.width?(u++,I()):e.x-e.radius<0&&(e.dx=5,D++,I())}function w(a,H){if(t.clearRect(0,0,n.width,n.height),H&&(t.setLineDash([10,5]),t.beginPath(),t.moveTo(n.width/2,0),t.lineTo(n.width/2,n.height),t.strokeStyle="#ffffff",t.lineWidth=3,t.stroke(),t.setLineDash([])),a&&(t.font="32px monospace",t.fillText(u,n.width/4,50),t.fillText(D,3*n.width/4,50)),t.lineWidth=1,t.beginPath(),t.arc(e.x,e.y,e.radius,0,Math.PI*2),t.fillStyle="#ffffff",t.strokeStyle="#000000",t.fill(),t.stroke(),t.closePath(),t.fillStyle="#ffffff",t.strokeStyle="#000000",!y){t.font="22px monospace",t.fillText("Bot",s.x+10+8,s.y+80);let W=t.measureText("You");t.fillText("You",d.x-10-5-W.width,d.y+80)}t.fillRect(s.x,s.y,10,80),t.strokeRect(s.x,s.y,10,80),t.fillRect(d.x,d.y,10,80),t.strokeRect(d.x,d.y,10,80)}function I(){c=8,e.x=n.width/2,e.y=n.height/2,e.prevX=e.x,e.prevY=e.y,e.dx=e.dx<0?5:-5,e.dy=Math.random()*8-4}}}function M(f,i){let h=(f.x-i.prevX+(i.dx>0?-i.radius:10+i.radius))/i.dx;if(h<0||h>1)return;let r=i.prevY+i.dy*h;if(r+i.radius>f.y&&r-i.radius<f.y+80){i.x=i.prevX+i.dx*h,i.y=r,i.dx=-i.dx*1.05;let l=f.y+80/2;return i.dy+=(i.y-l)*.1,!0}return!1}function x(f,i){return Math.floor(Math.random()*(i-f+1))+f}function G(f,i){for(let h of Object.keys(i))f.style[h]=i[h]}export{B as create};
